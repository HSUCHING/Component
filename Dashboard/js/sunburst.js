/**
 * Created by chinghsu on 17/1/2.
 */
skillsdata = {
    "Skills": {
        "Server & WinForm": {
            "Protocol": {
                "Propose": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 30, 50, 50, 50],
                "USSD": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 60, 60, 50, 40, 30],
                "UAP": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 60, 70, 50, 30],
                "Socket Raw": [0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 50, 50, 50, 70, 80]
            },
            "Optimization": {
                "Performance": [0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 40, 40, 50, 50, 50],
                "Distribute": [0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 10, 10, 40, 50, 50],
                "Stability": [0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 50, 60, 70, 80, 90]
            },
            "UI": {
                "WinForm": [0, 0, 20, 40, 50, 50, 50, 50, 60, 80, 90, 95, 95, 95, 95],
                "WPF": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 30, 50],
                "GDI": [0, 0, 0, 0, 0, 40, 50, 40, 40, 30, 30, 20, 20, 10, 5],
                "DX": [0, 0, 0, 0, 0, 10, 50, 50, 40, 40, 30, 20, 10, 10, 5],
                "Flash": [0, 0, 10, 30, 40, 50, 50, 40, 30, 20, 10, 5, 5, 5, 5]
            },
            "Algorithm": {
                "Image Processing": [0, 0, 0, 0, 0, 0, 0, 10, 30, 50, 50, 50, 45, 45, 40],
                "Face recognition": [0, 0, 0, 0, 0, 0, 0, 10, 40, 70, 60, 50, 40, 40, 40]
            }
        },
        "Web Development": {
            "Server Side": {
                "Active Page": {
                    "ASP": [0, 0, 10, 30, 60, 60, 40, 20, 20, 20, 20, 20, 20, 20, 20],
                    "ASP.Net": [0, 0, 0, 0, 0, 0, 10, 30, 70, 80, 90, 90, 90, 90, 90]
                },
                "Node.js": {
                    "express": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 30],
                    "npm": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 40]
                },
                "DB": {
                    "SqlServer": [0, 0, 0, 0, 0, 10, 20, 40, 40, 40, 60, 90, 90, 90, 80],
                    "Sqlite": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 30, 20],
                    "Mongo": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 30]
                },
                "Server": {
                    "IIS": [0, 10, 10, 30, 40, 40, 40, 60, 70, 70, 80, 80, 80, 80, 80],
                    "Apache": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 20, 40]
                },
                "API": {
                    "OAuth2.0": [0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 40, 40, 40, 30, 30],
                    "WeChat": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 30, 30],
                    "Propose": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 30, 40, 30]
                }
            },
            "Front Side": {
                "HTML": [0, 0, 10, 30, 50, 50, 60, 80, 90, 60, 50, 30, 30, 30, 40],
                "CSS": {
                    "CSS": [0, 0, 10, 30, 50, 50, 60, 80, 85, 60, 50, 30, 20, 20, 30],
                    "LESS": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 30],
                    "Responsive": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20]
                },
                "JSFramework": {
                    "jQuery": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 30, 30, 25, 30],
                    "ExtJs": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 30, 30],
                    "BackboneJs": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10],
                    "D3.js": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20],
                    "Rapheal": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20],
                    "kinetic": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20]
                },
                "Template": {
                    "Jade": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20],
                    "Razor": [0, 0, 0, 0, 0, 0, 0, 0, 0, 40, 50, 60, 80, 80, 80]
                }
            }
        },
        "Language": {
            "Dotnet": {
                "C#": [0, 0, 0, 0, 0, 0, 20, 50, 70, 80, 90, 95, 95, 95, 95],
                "Xaml": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 30, 50],
                "F#": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 30, 30, 30]
            },
            "Script": {
                "Javascript": [0, 0, 10, 30, 50, 50, 60, 60, 60, 80, 80, 60, 50, 50, 60],
                "VBScript": [0, 0, 0, 0, 20, 20, 30, 30, 40, 30, 20, 20, 20, 20, 20],
                "CoffeeScript": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 30, 50],
                "Python": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20]
            },
            "Java": {
                "Android": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 30]
            },
            "Embedded": {
                "X86 Asm": [0, 0, 0, 0, 0, 0, 0, 0, 10, 40, 40, 30, 25, 20, 20],
                "C": [0, 0, 0, 0, 0, 0, 0, 20, 25, 30, 50, 50, 45, 40, 40]
            },
            "Other": {
                "T-SQL": [0, 0, 0, 0, 0, 10, 20, 40, 40, 40, 60, 90, 90, 90, 80],
                "(E)BNF": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 30],
                "XSD/XSLT": [0, 0, 0, 0, 0, 0, 20, 40, 40, 40, 40, 40, 50, 50, 60],
                "QB": [40, 50, 40, 30, 20, 10, 5, 5, 5, 5, 5, 5, 5, 5, 5],
                "VB": [0, 10, 20, 50, 60, 80, 90, 80, 70, 60, 60, 60, 60, 50, 50],
                "Pascal": [0, 0, 0, 30, 50, 60, 40, 20, 10, 5, 5, 5, 5, 5, 5],
                "IEC61131": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 40]
            }
        },
        "Other": {
            "HW&FW": {
                "Protues": [0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 30, 25, 20, 20, 25],
                "Keil": [0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 30, 25, 20, 20, 25],
                "Code Warrior": [0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 15, 15, 10, 10, 20],
                "Protel": [0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 20, 15, 10, 10, 5],
                "Multisim": [0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 30, 30, 25, 20, 15],
                "Lego": [0, 0, 0, 0, 10, 40, 50, 45, 40, 35, 30, 25, 20, 15, 10]
            },
            "Productivity": {
                "Vim": [0, 0, 0, 0, 0, 0, 0, 0, 10, 20, 30, 40, 45, 50, 55],
                "AHK": [0, 0, 0, 0, 0, 0, 0, 0, 10, 20, 30, 30, 30, 35, 40],
                "Office": [0, 10, 20, 50, 60, 60, 70, 70, 80, 90, 90, 90, 90, 90, 90],
                "Photoshop": [0, 10, 20, 30, 35, 40, 45, 50, 60, 65, 60, 60, 55, 60, 60],
                "Batch": [40, 45, 50, 50, 50, 60, 65, 70, 75, 75, 80, 80, 80, 80, 80],
                "Shell": [0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 10, 10, 30, 35, 40],
                "Linux": [0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 10, 10, 40, 50, 55],
                "Marked Text": [10, 20, 20, 30, 40, 40, 40, 40, 40, 50, 60, 70, 80, 80, 80]
            },
            "Project": {
                "Agile": [0, 0, 0, 0, 0, 0, 0, 0, 10, 30, 40, 50, 60, 70, 80],
                "CI": [0, 0, 0, 0, 0, 0, 0, 0, 10, 30, 50, 70, 70, 80, 80],
                "Repos": {
                    "Git": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 30, 50],
                    "SVN": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 30, 50, 50, 50],
                    "Clearcase": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 30]
                },
                "Track": {
                    "Redmine": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 30],
                    "Trello": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 10, 20]
                },
                "Wiki": [0, 0, 0, 0, 0, 0, 0, 0, 10, 40, 50, 40, 40, 40, 40],
                "Quality Assurance": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 30, 50, 60, 60]
            },
            "Cloud": {
                "IaaS": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 10, 15],
                "PaaS": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15, 30, 30],
                "SaaS": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 10, 10]
            },
            "Test": {
                "TDD": [0, 0, 0, 0, 0, 0, 0, 0, 5, 10, 5, 5, 15, 5, 5],
                "cucumber": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 0, 10, 30],
                "Load test": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40, 30, 25, 20, 15]
            }
        }
    }
};
function getcrumbpath(a) {
    for (var temp = [], c = a; c.parent;) temp.unshift(c), c = c.parent;
    return temp;
}

if (!window.TouchEvents) {


    var TouchEvents = (function () {
        var supportTouch = function () {
            return !!('ontouchstart' in window || window.DocumentTouch && document instanceof DocumentTouch);
        }();
        return {
            start: supportTouch ? 'touchstart' : 'mousedown',
            move: supportTouch ? 'touchmove' : 'mousemove',
            end: supportTouch ? 'touchend' : 'mouseup'
        }
    })();

    window.TouchEvents = TouchEvents;
}

function initchart() {
    var data = {
        _proficiency: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        children: null,
        value: 0,
        key: "",
        depth: 1
    };
    sunBurst.render();
    chart.render(data);

    // chart.refreshChart(data);
}

function isArray(o) {
    return Object.prototype.toString.call(o) == '[object Array]';
}
function isObject(o) {
    return Object.prototype.toString.call(o) == '[object Object]';
}

function buildHierarchy(data, name) {
    var root = {};
    var tmpdata = data;
    root.name = name;
    if (!name) {
        root.name = Object.keys(data)[0];
        tmpdata = data[root.name];
    }
    if (isObject(tmpdata)) {
        root.children = [];
        for (var tmpkey in tmpdata) {
            root.children.push(buildHierarchy(tmpdata[tmpkey], tmpkey));
        }
    } else {
        root.size = 10;
    }

    return root;
};

var dataSkillsV4 = buildHierarchy(skillsdata);


var sunBurst = function (d3) {

    var _sunBurst = {};
    var sunburst, width = 400,
        height = 400, radius = Math.min(width, height) / 2;
    var colors = d3.scaleOrdinal(d3.schemeCategory10);
    var coloralternative = 0;

    function colorRange(a) {
        var c = ["#4CC3D9", "#FFC65D", "#7BC8A4", "#93648D", "#404040"],
            d = [-.1, -.05, 0];
        if (1 == a.depth) {
            var e = c[coloralternative % 5];
            return coloralternative++, e
        }
        if (a.depth > 1) {
            var f = d[a.value % 3];
            return d3.rgb(a.parent._color).brighter(.2 * a.depth + f * a.depth)
        }
    }

    function mouseover(data) {
        // chart.refreshChart(data);
        var c = getcrumbpath(data);
        // i(c);
        d3
            .selectAll(".skills-sunburst path")
            .style("opacity", .3), sunburst
            .selectAll("path")
            .filter(function (a) {
                return c.indexOf(a) >= 0
            })
            .style("opacity", 1)
    }

    var center = {
        cx: 0,
        cy: 0
    };
    var rotatePosition = 0;
    var active=false;
    var virtualAngle = 0, lastMouseAngle = undefined, lastElementAngle = undefined;

    function touchStart() {
        active=true;
        lastMouseAngle = undefined;
        lastElementAngle = undefined;
        lastMouseEvent = undefined;
    }

    function touchMove() {
        if(active) {
            // var xDiff = event.pageX || event.touches[0].pageX - touchPosition.x;
            // var yDiff = event.pageY || event.touches[0].pageY - touchPosition.y;
            var xDiff = (event.pageX || event.touches[0].pageX) - center.cx;
            var yDiff = (event.pageY || event.touches[0].pageY) - center.cy;
            var mouseRadians = Math.atan2(xDiff, yDiff);
            var mouseDegrees = mouseRadians * (180 / Math.PI * -1) + 180;
            // console.log(mouseRadians * (180 / Math.PI * -1));
            if (lastMouseAngle === undefined) {
                lastElementAngle = virtualAngle;
                lastMouseAngle = mouseDegrees;
            }

            // var oldAngle = virtualAngle;
            var mouseDiff = mouseDegrees - lastMouseAngle;
            virtualAngle = lastElementAngle + mouseDiff;
            // var newAngle = virtualAngle;
            // this.speed = this.differenceBetweenAngles(newAngle, oldAngle);


            console.log(xDiff+":"+yDiff);
            var rotation = normalizeAngle(virtualAngle);
            virtualAngle = rotation;

            // rotatePosition+=((event.pageY||event.touches[0].pageY)-touchPosition.y)/10;
            var _svg = arguments[2][0];
            // if (Math.abs(this.lastAppliedAngle - this._angle) >= this.minimalAngleChange{
            //
            // }
            _svg.style.transform = "rotateZ(" + rotation + "deg)";
            // rotatePosition = rotation;
            // touchPosition.x = event.pageX || event.touches[0].pageX;
            // touchPosition.y = event.pageY || event.touches[0].pageY;
        }
    }

    function normalizeAngle(angle) {
        var result = angle;
        result = result % 360;
        if (result < 0) {
            result = 360 + result;
        }
        return result;
    }

    differenceBetweenAngles = function (newAngle, oldAngle) {
        var a1 = newAngle * (Math.PI / 180);
        var a2 = oldAngle * (Math.PI / 180);
        var radians = Math.atan2(Math.sin(a1 - a2), Math.cos(a1 - a2));
        var degrees = radians * (180 / Math.PI);
        return Math.round(degrees * 100) / 100;
    }


    function touchEnd() {
        active=false;
    }

    _sunBurst.render = function () {
        sunburst = d3
            .select(".skills-sunburst")
            .append("svg:svg")
            .on(TouchEvents.start, touchStart)
            .on(TouchEvents.move, touchMove)
            .on(TouchEvents.end, touchEnd)
            .attr("width", width)
            .attr("height", height)
            .append("svg:g")
            .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");
        // sunburst.append("svg:circle").attr("r", rad).style("opacity", 1);
        renderPartition();
        centerCoordinates(sunburst.node().parentNode);

    };

    function centerCoordinates(svgNode) {
        var elementOffset = getViewOffset(svgNode);
        center.cx = elementOffset.x + (svgNode.getBoundingClientRect().width / 2);
        center.cy = elementOffset.y + (svgNode.getBoundingClientRect().height / 2);
    }

    function getViewOffset(svgNode) {
        var coords = {x: 0, y: 0};

        if (svgNode)
            addOffset(svgNode, coords, 'defaultView' in document ? document.defaultView : document.parentWindow);

        return coords;
    }

    var addOffset = function (node, coords, view) {
        var p = node.offsetParent;
        coords.x += node.getBoundingClientRect().left - (p ? p.scrollLeft : 0);
        coords.y += node.getBoundingClientRect().top - (p ? p.scrollTop : 0);

        if (p) {
            if (p.nodeType == 1) {
                var parentStyle = view.getComputedStyle(p, '');
                if (parentStyle.position != 'static') {
                    coords.x += parseInt(parentStyle.borderLeftWidth);
                    coords.y += parseInt(parentStyle.borderTopWidth);

                    if (p.localName.toLowerCase() == 'table') {
                        coords.x += parseInt(parentStyle.paddingLeft);
                        coords.y += parseInt(parentStyle.paddingTop);
                    }
                    else if (p.localName.toLowerCase() == 'body') {
                        var style = view.getComputedStyle(node, '');
                        coords.x += parseInt(style.marginLeft);
                        coords.y += parseInt(style.marginTop);
                    }
                }
                else if (p.localName.toLowerCase() == 'body') {
                    coords.x += parseInt(parentStyle.borderLeftWidth);
                    coords.y += parseInt(parentStyle.borderTopWidth);
                }

                var parent = node.parentNode;
                while (p != parent) {
                    coords.x -= parent.scrollLeft;
                    coords.y -= parent.scrollTop;
                    parent = parent.parentNode;
                }
                addOffset(p, coords, view);
            }
        }
        else {
            if (node.localName.toLowerCase() == 'body') {
                var style = view.getComputedStyle(node, '');
                coords.x += parseInt(style.borderLeftWidth);
                coords.y += parseInt(style.borderTopWidth);

                var htmlStyle = view.getComputedStyle(node.parentNode, '');
                coords.x += parseInt(htmlStyle.paddingLeft);
                coords.y += parseInt(htmlStyle.paddingTop);
                coords.x += parseInt(htmlStyle.marginLeft);
                coords.y += parseInt(htmlStyle.marginTop);
            }

            if (node.scrollLeft)
                coords.x += node.scrollLeft;
            if (node.scrollTop)
                coords.y += node.scrollTop;

            var win = node.ownerDocument.defaultView;
            if (win && (win.frameElement))
                addOffset(win.frameElement, coords, win);
        }
    };


    // var t = function (a, b) {
    //         var c = [],
    //             d = a.length;
    //         if (a.length !== b.length) c = a.length > b.length ? a : b;
    //         else for (var e = 0; d > e; e++) {
    //             var f = Math.max(a[e], b[e]) - Math.abs(a[e] - b[e]) / 8;
    //             c.push(f)
    //         }
    //         return c
    //     },
    //     u = function (a) {
    //         if (a instanceof Array) return a;
    //         var b = [];
    //         a.every(function (a, c) {
    //             b = t(u(c), b)
    //         });
    //         return b;
    //     };

    var xScale = d3.scaleLinear()
        .domain([0, radius])
        .range([0, Math.PI * 2])
        .clamp(true);

    function renderPartition() {


        var root = d3.hierarchy(dataSkillsV4, function (d) {
            return d.children;
        })
            .sum(function (d) {
                if (d.children) {
                    return 0;
                } else {
                    return 1;
                }
            })
            .sort(null);
        var partition = d3
            .partition()
            .size([radius, radius])
            .padding(0);
        partition(root);
        var arc = d3.arc()
            .startAngle(function (d) {
                return xScale(d.x0)
            })
            .endAngle(function (d) {
                return xScale(d.x1)
            })
            .innerRadius(function (d) {
                return d.y0
            })
            .outerRadius(function (d) {
                return d.y1
            });

        var g = sunburst.selectAll('g')
            .data(root.descendants())
            .enter().append('g');

        g.append('path')
            .attr("display", function (d) {
                return d.depth ? null : "none";
            })
            .attr("d", arc)
            .attr("fill-rule", "evenodd")
            .style('stroke', '#fff')
            .style("fill", function (a) {
                return a._color = colorRange(a), a._color
            })
            .on("mouseover", mouseover);

        g.append("svg:text")
            .attr("transform", function (a) {
                var r = 180 * ((xScale(a.x0) + xScale(a.x1)) / 2 - Math.PI / 2) / Math.PI;
                return "rotate(" + r + ")"
            })
            .attr("x", function (a) {
                return a.y0
            })
            .attr("dx", "5").attr("dy", ".4em").text(function (a) {
                return a.data.name;
            })
            .attr("display", function (a) {
                return a.depth != 0 ? null : "none"
            });


    }


    return _sunBurst;

}(d3);


var chart = (function (d3) {
    var _chart = {}, margin = {
            left: 50,
            right: 20,
            top: 20,
            bottom: 30
        }, width = 500,
        height = 400, _colors = d3.scaleOrdinal(d3.schemeCategory10),
        _svg, xData, _line;
    var yearSpan = [1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013];

    var xAxis = d3.scaleLinear().rangeRound([0, quadrantWidth()]);
    var yAxis = d3.scaleLinear().rangeRound([quadrantHeight(), 0]);

    function processdata(data) {
        var _data = [],
            c = 0;
        return data._proficiency.forEach(function (a) {
            c <= yearSpan.length && (_data.push({
                p: a,
                date: yearSpan[c]
            }), c++)
        }), _data
    };


    _chart.render = function (data) {
        xData = processdata(data);
        var chartLine = d3.select("#skills-chart-line");
        if (!_svg) {
            _svg = d3.select(".skills-chart")
                .attr("class", "chart")
                .style("text-align", "center")
                .append("svg")
                .attr("height", height)
                .attr("width", width);
        }
        if (!chartLine[0]) {
            renderAxes(_svg);
        } else {
            renderLine(_svg.select(".lineCurve"), xData);
            chartLine
                .datum(e)
                .attr("d", _line)
                .attr("stroke", function () {
                    // return data._color
                });
        }
        // renderChart(_svg);
    };

    function renderLine(lineChart, data) {
        _line = d3.line().curve(d3.curveBasis()).x(function (a) {
            return xAxis(a.date)
        }).y(function (a) {
            return yAxis(a.p)
        });

        lineChart
            .append("path")
            .datum(data)
            .attr("class", "line")
            .attr("id", "skills-chart-line")
            .attr("d", _line)
            .attr("stroke", function () {
                // return c._color
                return 'red';
            })

    }


    function renderAxes(svg) {
        var axesG = svg.append("g")
            .attr("class", "lineCurve")
            .attr("transform", "translate(" + xStart() + "," + yEnd() + ")");

        renderXAxis(axesG);

        renderYAxis(axesG);
    }

    function renderXAxis(axesG) {
        xAxis = xAxis.domain(d3.extent(xData, function (a) {
            return a.date
        }));
        axesG.append("g")
            .attr("class", "x axis")
            .attr("transform", "translate(0," + quadrantHeight() + ")")
            .call(d3.axisBottom(xAxis).tickValues([1999, 2004, 2009, 2013]).tickPadding(10).tickSize(0))
            .append("text")
            .attr("x", quadrantWidth() / 2)
            .attr("y", 30)
            .attr("stroke", "black")
            .attr("text-anchor", "center")
            .text("Year");

    }

    function renderYAxis(axesG) {
        yAxis = yAxis.domain([0, 100]);
        axesG.append("g")
            .attr("class", "axis y")
            .attr("transform", "translate(0,0)")
            .call(d3.axisLeft(yAxis).tickSize(0).tickPadding(10).tickValues([20, 40, 60, 80, 100]))
            .append("text")
            .attr("transform", "rotate(-90)")
            .attr("y", -xStart() / 1.2)
            .attr("x", -quadrantHeight() / 2)
            .attr("stroke", "black")
            .attr("text-anchor", "end")
            .text("Proficiency");
    }

    function xStart() {
        return margin.left;
    }

    function yStart() {
        return height - margin.bottom;
    }

    function xEnd() {
        return width - margin.right;
    }

    function yEnd() {
        return margin.top;
    }

    function quadrantWidth() {
        return width - margin.left - margin.right;
    }

    function quadrantHeight() {
        return height - margin.top - margin.bottom;
    }


    return _chart;
})(d3);

// function refreshChart(data) {
//     var e = processdata(data),
//         f = d3.select("#skills-chart-line");
//     null === f[0][0]
//         ? c(e, data)
//         : f
//         .datum(e)
//         .attr("d", n)
//         .attr("stroke", function () {
//             return data._color
//         })
// }


initchart();