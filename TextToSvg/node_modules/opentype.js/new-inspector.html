<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Font Inspector</title>
    <script type="text/javascript" src="dist/opentype.js"></script>
</head>
<body>
    <input id="file" type="file">
    <span class="info" id="font-name"></span>
    <div id="message"></div>


<script>

function showErrorMessage(message) {
    var el = document.getElementById('message');
    if (!message || message.trim().length === 0) {
        el.style.display = 'none';
    } else {
        el.style.display = 'block';
    }
    el.innerHTML = message;
}

function visualizeBytes(buffer) {
    console.log(buffer.byteLength);

    var dv = new DataView(buffer, 0);

    var array = new Uint8Array(buffer);

    for (var i = 0; i < 100; i++) {
        console.log(array[i]);
    }

    // var varsion = opentype._parse.getFixed(data, 0);
    // if (version === 1.0) {
    //     console.log('Version: ' + version);
    // }
    //     font.outlinesFormat = 'truetype';

    // document.create
    // document.appendChild()
}

function visualizeFont() {
    //var data = new DataView(buffer, 0);
    var array = new Uint8Array(buffer);
    array[0];
    version = parse.getFixed(data, 0);




}

function onReadFile(e) {
    document.getElementById('font-name').innerHTML = '';
    var file = e.target.files[0];
    var reader = new FileReader();
    reader.onload = function(e) {
        console.log(e.target.result);
        //window.font = opentype.parse(e.target.result);
        visualizeBytes(e.target.result);
        //visualizeFont(window.font);
    }
    reader.onerror = function(err) {
        showErrorMessage(err.toString());
    }
    reader.readAsArrayBuffer(file);
}


var fileButton = document.getElementById('file');
fileButton.addEventListener('change', onReadFile, false);

function loadFromUrl(url, callback) {
    var request = new XMLHttpRequest();
    request.open('get', url, true);
    request.responseType = 'arraybuffer';
    request.onload = function() {
        if (request.status !== 200) {
            callback(request.status, null);
        }
        return callback(null, request.response);
    };
    request.send();
}

loadFromUrl('fonts/FiraSansOT-Medium.otf', function(err, buffer) {
    console.log(buffer);
    visualizeBytes(buffer);

});

</script>
</body>
</html>