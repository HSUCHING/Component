{"version":3,"sources":["swagger-oauth.js"],"names":[],"mappings":"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","file":"swagger-oauth-compiled.js","sourcesContent":["var appName;\nvar popupMask;\nvar popupDialog;\nvar clientId;\nvar realm;\nvar redirect_uri;\nvar clientSecret;\nvar scopeSeparator;\nvar additionalQueryStringParams;\n\nfunction handleLogin() {\n  var scopes = [];\n\n  var auths = window.swaggerUi.api.authSchemes || window.swaggerUi.api.securityDefinitions;\n  if(auths) {\n    var key;\n    var defs = auths;\n    for(key in defs) {\n      var auth = defs[key];\n      if(auth.type === 'oauth2' && auth.scopes) {\n        var scope;\n        if(Array.isArray(auth.scopes)) {\n          // 1.2 support\n          var i;\n          for(i = 0; i < auth.scopes.length; i++) {\n            scopes.push(auth.scopes[i]);\n          }\n        }\n        else {\n          // 2.0 support\n          for(scope in auth.scopes) {\n            scopes.push({scope: scope, description: auth.scopes[scope], OAuthSchemeKey: key});\n          }\n        }\n      }\n    }\n  }\n\n  if(window.swaggerUi.api\n    && window.swaggerUi.api.info) {\n    appName = window.swaggerUi.api.info.title;\n  }\n\n  $('.api-popup-dialog').remove(); \n  popupDialog = $(\n    [\n      '<div class=\"api-popup-dialog\">',\n      '<div class=\"api-popup-title\">Select OAuth2.0 Scopes</div>',\n      '<div class=\"api-popup-content\">',\n        '<p>Scopes are used to grant an application different levels of access to data on behalf of the end user. Each API may declare one or more scopes.',\n          '<a href=\"#\">Learn how to use</a>',\n        '</p>',\n        '<p><strong>' + appName + '</strong> API requires the following scopes. Select which ones you want to grant to Swagger UI.</p>',\n        '<ul class=\"api-popup-scopes\">',\n        '</ul>',\n        '<p class=\"error-msg\"></p>',\n        '<div class=\"api-popup-actions\"><button class=\"api-popup-authbtn api-button green\" type=\"button\">Authorize</button><button class=\"api-popup-cancel api-button gray\" type=\"button\">Cancel</button></div>',\n      '</div>',\n      '</div>'].join(''));\n  $(document.body).append(popupDialog);\n\n  //TODO: only display applicable scopes (will need to pass them into handleLogin)\n  popup = popupDialog.find('ul.api-popup-scopes').empty();\n  for (i = 0; i < scopes.length; i ++) {\n    scope = scopes[i];\n    str = '<li><input type=\"checkbox\" id=\"scope_' + i + '\" scope=\"' + scope.scope + '\"' +'\" oauthtype=\"' + scope.OAuthSchemeKey +'\"/>' + '<label for=\"scope_' + i + '\">' + scope.scope ;\n    if (scope.description) {\n      if ($.map(auths, function(n, i) { return i; }).length > 1) //if we have more than one scheme, display schemes\n\t    str += '<br/><span class=\"api-scope-desc\">' + scope.description + ' ('+ scope.OAuthSchemeKey+')' +'</span>';\n\t  else\n\t    str += '<br/><span class=\"api-scope-desc\">' + scope.description + '</span>';\n    }\n    str += '</label></li>';\n    popup.append(str);\n  }\n\n  var $win = $(window),\n    dw = $win.width(),\n    dh = $win.height(),\n    st = $win.scrollTop(),\n    dlgWd = popupDialog.outerWidth(),\n    dlgHt = popupDialog.outerHeight(),\n    top = (dh -dlgHt)/2 + st,\n    left = (dw - dlgWd)/2;\n\n  popupDialog.css({\n    top: (top < 0? 0 : top) + 'px',\n    left: (left < 0? 0 : left) + 'px'\n  });\n\n  popupDialog.find('button.api-popup-cancel').click(function() {\n    popupMask.hide();\n    popupDialog.hide();\n    popupDialog.empty();\n    popupDialog = [];\n  });\n\n  $('button.api-popup-authbtn').unbind();\n  popupDialog.find('button.api-popup-authbtn').click(function() {\n    popupMask.hide();\n    popupDialog.hide();\n\n    var authSchemes = window.swaggerUi.api.authSchemes;\n    var host = window.location;\n    var pathname = location.pathname.substring(0, location.pathname.lastIndexOf(\"/\"));\n    var defaultRedirectUrl = host.protocol + '//' + host.host + pathname + '/o2c.html';\n    var redirectUrl = window.oAuthRedirectUrl || defaultRedirectUrl;\n    var url = null;\n    var scopes = []\n    var o = popup.find('input:checked'); \n    var OAuthSchemeKeys = [];\n    var state;\n    for(k =0; k < o.length; k++) {\n      var scope = $(o[k]).attr('scope');\n      if (scopes.indexOf(scope) === -1)\n        scopes.push(scope);\n      var OAuthSchemeKey = $(o[k]).attr('oauthtype');      \n      if (OAuthSchemeKeys.indexOf(OAuthSchemeKey) === -1)\n          OAuthSchemeKeys.push(OAuthSchemeKey);\n    }\n    \n    //TODO: merge not replace if scheme is different from any existing \n    //(needs to be aware of schemes to do so correctly)\n    window.enabledScopes=scopes;    \n    \n    for (var key in authSchemes) { \n      if (authSchemes.hasOwnProperty(key) && OAuthSchemeKeys.indexOf(key) != -1) { //only look at keys that match this scope.\n        var flow = authSchemes[key].flow;\n\n        if(authSchemes[key].type === 'oauth2' && flow && (flow === 'implicit' || flow === 'accessCode')) {\n          var dets = authSchemes[key];\n          url = dets.authorizationUrl + '?response_type=' + (flow === 'implicit' ? 'token' : 'code');\n          window.swaggerUi.tokenName = dets.tokenName || 'access_token';\n          window.swaggerUi.tokenUrl = (flow === 'accessCode' ? dets.tokenUrl : null);\n          state = key;\n        }\n        else if(authSchemes[key].type === 'oauth2' && flow && (flow === 'application')) {\n            var dets = authSchemes[key];\n            window.swaggerUi.tokenName = dets.tokenName || 'access_token';\n            clientCredentialsFlow(scopes, dets.tokenUrl, key);\n            return;\n        }        \n        else if(authSchemes[key].grantTypes) {\n          // 1.2 support\n          var o = authSchemes[key].grantTypes;\n          for(var t in o) {\n            if(o.hasOwnProperty(t) && t === 'implicit') {\n              var dets = o[t];\n              var ep = dets.loginEndpoint.url;\n              url = dets.loginEndpoint.url + '?response_type=token';\n              window.swaggerUi.tokenName = dets.tokenName;\n            }\n            else if (o.hasOwnProperty(t) && t === 'accessCode') {\n              var dets = o[t];\n              var ep = dets.tokenRequestEndpoint.url;\n              url = dets.tokenRequestEndpoint.url + '?response_type=code';\n              window.swaggerUi.tokenName = dets.tokenName;\n            }\n          }\n        }\n      }\n    }\n\n    redirect_uri = redirectUrl;\n\n    url += '&redirect_uri=' + encodeURIComponent(redirectUrl);\n    url += '&realm=' + encodeURIComponent(realm);\n    url += '&client_id=' + encodeURIComponent(clientId);\n    url += '&scope=' + encodeURIComponent(scopes.join(scopeSeparator));\n    url += '&state=' + encodeURIComponent(state);\n    for (var key in additionalQueryStringParams) {\n        url += '&' + key + '=' + encodeURIComponent(additionalQueryStringParams[key]);\n    }\n\n    window.open(url);\n  });\n\n  popupMask.show();\n  popupDialog.show();\n  return;\n}\n\n\nfunction handleLogout() {\n  for(key in window.swaggerUi.api.clientAuthorizations.authz){\n    window.swaggerUi.api.clientAuthorizations.remove(key)\n  }\n  window.enabledScopes = null;\n  $('.api-ic.ic-on').addClass('ic-off');\n  $('.api-ic.ic-on').removeClass('ic-on');\n\n  // set the info box\n  $('.api-ic.ic-warning').addClass('ic-error');\n  $('.api-ic.ic-warning').removeClass('ic-warning');\n}\n\nfunction initOAuth(opts) {\n  var o = (opts||{});\n  var errors = [];\n\n  appName = (o.appName||errors.push('missing appName'));\n  popupMask = (o.popupMask||$('#api-common-mask'));\n  popupDialog = (o.popupDialog||$('.api-popup-dialog'));\n  clientId = (o.clientId||errors.push('missing client id'));\n  clientSecret = (o.clientSecret||null);\n  realm = (o.realm||errors.push('missing realm'));\n  scopeSeparator = (o.scopeSeparator||' ');\n  additionalQueryStringParams = (o.additionalQueryStringParams||{});\n\n  if(errors.length > 0){\n    log('auth unable initialize oauth: ' + errors);\n    return;\n  }\n\n  $('pre code').each(function(i, e) {hljs.highlightBlock(e)});\n  $('.api-ic').unbind();\n  $('.api-ic').click(function(s) {\n    if($(s.target).hasClass('ic-off'))\n      handleLogin();\n    else {\n      handleLogout();\n    }\n    false;\n  });\n}\n\nfunction clientCredentialsFlow(scopes, tokenUrl, OAuthSchemeKey) {\n    var params = {\n      'client_id': clientId,\n      'client_secret': clientSecret,\n      'scope': scopes.join(' '),\n      'grant_type': 'client_credentials'\n    }\n    $.ajax(\n    {\n      url : tokenUrl,\n      type: \"POST\",\n      data: params,\n      success:function(data, textStatus, jqXHR)\n      {\n        onOAuthComplete(data,OAuthSchemeKey);\n      },\n      error: function(jqXHR, textStatus, errorThrown)\n      {\n        onOAuthComplete(\"\");\n      }\n    });\n    \n  }\n\nwindow.processOAuthCode = function processOAuthCode(data) {\n  var OAuthSchemeKey = data.state;\n\n  // redirect_uri is required in auth code flow \n  // see https://tools.ietf.org/html/draft-ietf-oauth-v2-31#section-4.1.3\n  var host = window.location;\n  var pathname = location.pathname.substring(0, location.pathname.lastIndexOf(\"/\"));\n  var defaultRedirectUrl = host.protocol + '//' + host.host + pathname + '/o2c.html';\n  var redirectUrl = window.oAuthRedirectUrl || defaultRedirectUrl;\n\n  var params = {\n    'client_id': clientId,\n    'code': data.code,\n    'grant_type': 'authorization_code',\n    'redirect_uri': redirectUrl\n  };\n\n  if (clientSecret) {\n    params.client_secret = clientSecret;\n  }\n\n  $.ajax(\n  {\n    url : window.swaggerUi.tokenUrl,\n    type: \"POST\",\n    data: params,\n    success:function(data, textStatus, jqXHR)\n    {\n      onOAuthComplete(data, OAuthSchemeKey);\n    },\n    error: function(jqXHR, textStatus, errorThrown)\n    {\n      onOAuthComplete(\"\");\n    }\n  });\n};\n\nwindow.onOAuthComplete = function onOAuthComplete(token,OAuthSchemeKey) {\n  if(token) {\n    if(token.error) {\n      var checkbox = $('input[type=checkbox],.secured')\n      checkbox.each(function(pos){\n        checkbox[pos].checked = false;\n      });\n      alert(token.error);\n    }\n    else {\n      var b = token[window.swaggerUi.tokenName];      \n      if (!OAuthSchemeKey){\n          OAuthSchemeKey = token.state;\n      }\n      if(b){\n        // if all roles are satisfied\n        var o = null;\n        $.each($('.auth .api-ic .api_information_panel'), function(k, v) { \n          var children = v;\n          if(children && children.childNodes) {\n            var requiredScopes = [];\n            $.each((children.childNodes), function (k1, v1){\n              var inner = v1.innerHTML;\n              if(inner)\n                requiredScopes.push(inner);\n            });\n            var diff = [];\n            for(var i=0; i < requiredScopes.length; i++) {\n              var s = requiredScopes[i];\n              if(window.enabledScopes && window.enabledScopes.indexOf(s) == -1) {\n                diff.push(s);\n              }\n            }\n            if(diff.length > 0){\n              o = v.parentNode.parentNode;\n              $(o.parentNode).find('.api-ic.ic-on').addClass('ic-off');\n              $(o.parentNode).find('.api-ic.ic-on').removeClass('ic-on');\n\n              // sorry, not all scopes are satisfied\n              $(o).find('.api-ic').addClass('ic-warning');\n              $(o).find('.api-ic').removeClass('ic-error');\n            }\n            else {\n              o = v.parentNode.parentNode;\n              $(o.parentNode).find('.api-ic.ic-off').addClass('ic-on');\n              $(o.parentNode).find('.api-ic.ic-off').removeClass('ic-off');\n\n              // all scopes are satisfied\n              $(o).find('.api-ic').addClass('ic-info');\n              $(o).find('.api-ic').removeClass('ic-warning');\n              $(o).find('.api-ic').removeClass('ic-error');\n            }\n          }\n        });\n        window.swaggerUi.api.clientAuthorizations.add(window.OAuthSchemeKey, new SwaggerClient.ApiKeyAuthorization('Authorization', 'Bearer ' + b, 'header'));\n        window.swaggerUi.load();\n      }\n    }\n  }\n};\n"]}